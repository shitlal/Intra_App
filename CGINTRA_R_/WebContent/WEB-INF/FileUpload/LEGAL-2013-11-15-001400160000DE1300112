
SELECT MEM_BANK_NAME BANK,SSI_STATE_NAME,SSI_DISTRICT_NAME,MEM_ZONE_NAME ZONE,DECODE(MEM_BRANCH_NAME,NULL, 
                                 APP_MLI_BRANCH_NAME,MEM_BRANCH_NAME) BRANCH,
M.MEM_BNK_ID||M.MEM_ZNE_ID||M.MEM_BRN_ID MEMBERID,S.SSI_UNIT_NAME UNITNAME,D.DAN_ID DANID,A.CGPAN CGPAN,TO_CHAR(APP_GUAR_START_DATE_TIME,'dd/mm/yyyy')GuaranteStartDate,DECODE(APP_REAPPROVE_AMOUNT,NULL,APP_APPROVED_AMOUNT,APP_REAPPROVE_AMOUNT)AS ApprovedAmount,(DCI_AMOUNT_RAISED) GFAMOUNT,app_status,APP_DC_HANDICRAFT_ACC_FLAG,APP_DC_HANDICRAFT_REIMB,APP_REMARKS
FROM DAN_CGPAN_INFO D,DEMAND_ADVICE_INFO DAI,MEMBER_INFO M,APPLICATION_DETAIL A,SSI_DETAIL S
WHERE D.DAN_ID = DAI.DAN_ID
AND A.CGPAN=D.CGPAN
AND A.SSI_REFERENCE_NUMBER=S.SSI_REFERENCE_NUMBER AND APP_STATUS NOT IN('RE')AND D.PAY_ID IN(SELECT DISTINCT PAY_ID FROM PAYMENT_DETAIL WHERE PAY_INSTRUMENT_NUMBER='078762') AND DCI_REMARKS='APPROPRIATION DONE FROM DC(HANDICRAFT) FUND'
AND D.DAN_ID LIKE 'CG%' AND  A.APP_DC_HANDICRAFT_ACC_FLAG='Y' AND APP_DC_HANDICRAFT_REIMB='Y' AND DCI_ALLOCATION_FLAG='Y' AND DCI_APPROPRIATION_FLAG='Y' AND (DCI_AMOUNT_RAISED-NVL(DCI_AMOUNT_CANCELLED,0)) >0
AND DAI.MEM_BNK_ID = M.MEM_BNK_ID AND DAI.MEM_ZNE_ID = M.MEM_ZNE_ID AND DAI.MEM_BRN_ID = M.MEM_BRN_ID AND  TRUNC(APP_GUAR_START_DATE_TIME)  BETWEEN TO_DATE('01/04/2011','dd/mm/yyyy') AND TO_DATE('31/03/2012','dd/mm/yyyy') ORDER BY TO_CHAR(APP_GUAR_START_DATE_TIME,'dd/mm/yyyy') DESC




SELECT SUM(DCI_AMOUNT_RAISED) GFAMOUNT
FROM DAN_CGPAN_INFO D,DEMAND_ADVICE_INFO DAI,MEMBER_INFO M,APPLICATION_DETAIL A,SSI_DETAIL S
WHERE D.DAN_ID = DAI.DAN_ID
AND A.CGPAN=D.CGPAN
AND A.SSI_REFERENCE_NUMBER=S.SSI_REFERENCE_NUMBER AND APP_STATUS NOT IN('RE') AND  D.PAY_ID IN(SELECT DISTINCT PAY_ID FROM PAYMENT_DETAIL WHERE PAY_INSTRUMENT_NUMBER='078762') AND DCI_REMARKS='APPROPRIATION DONE FROM DC(HANDICRAFT) FUND'
AND D.DAN_ID LIKE 'CG%' AND  A.APP_DC_HANDICRAFT_ACC_FLAG='Y' AND APP_DC_HANDICRAFT_REIMB='Y' AND DCI_ALLOCATION_FLAG='Y' AND DCI_APPROPRIATION_FLAG='Y' AND (DCI_AMOUNT_RAISED-NVL(DCI_AMOUNT_CANCELLED,0)) >0
AND DAI.MEM_BNK_ID = M.MEM_BNK_ID AND DAI.MEM_ZNE_ID = M.MEM_ZNE_ID AND DAI.MEM_BRN_ID = M.MEM_BRN_ID AND  TRUNC(APP_GUAR_START_DATE_TIME)  BETWEEN TO_DATE('02/05/2011','dd/mm/yyyy') AND TO_DATE('02/05/2011','dd/mm/yyyy') ORDER BY TO_CHAR(APP_GUAR_START_DATE_TIME,'dd/mm/yyyy') DESC






SELECT COUNT(*) FROM APPLICATION_DETAIL  WHERE TRUNC(APP_APPROVED_DATE_TIME)  BETWEEN TO_DATE('02/05/2011','dd/mm/yyyy') AND TO_DATE('02/05/2011','dd/mm/yyyy') AND APP_DC_HANDICRAFT_ACC_FLAG='Y' AND APP_DC_HANDICRAFT_REIMB='Y'




SELECT COUNT(*) FROM APPLICATION_DETAIL  WHERE TRUNC(APP_GUAR_START_DATE_TIME)  BETWEEN TO_DATE('02/05/2011','dd/mm/yyyy') AND TO_DATE('02/05/2011','dd/mm/yyyy') AND APP_DC_HANDICRAFT_ACC_FLAG='Y' AND APP_DC_HANDICRAFT_REIMB='Y' AND APP_STATUS NOT IN('RE') AND APP_REMARKS IS  NULL


SELECT cgpan FROM APPLICATION_DETAIL  WHERE TRUNC(APP_GUAR_START_DATE_TIME)  BETWEEN TO_DATE('02/05/2011','dd/mm/yyyy') AND TO_DATE('02/05/2011','dd/mm/yyyy') AND APP_DC_HANDICRAFT_ACC_FLAG='Y' AND APP_DC_HANDICRAFT_REIMB='Y' AND APP_STATUS NOT IN('RE') AND APP_REMARKS IS  NULL




SELECT * FROM DAN_CGPAN_INFO WHERE cgpan='CG20110079721WC'


SELECT * FROM DAN_CGPAN_INFO WHERE cgpan='CG20110042672TC'

SELECT * FROM PAYMENT_DETAIL WHERE pay_id='RP-00250-29-04-2011'